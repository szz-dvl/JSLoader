<!DOCTYPE html>

<html>
  <head>
	
	<meta charset="utf-8" http-equiv="Content-Security-Policy" content="script-src 'self' * 'unsafe-eval'; object-src 'self';">
	<!-- <meta charset="utf-8"> -->
	
	<link rel="stylesheet" href="chrome://browser/content/extension.css">
	<link rel="stylesheet" href="../deps/json/json-formatter.css">
	<link rel="stylesheet" href="listener.css">

	<script src="../deps/jquery.min.js"></script>
	<script src="../deps/angular.min.js"></script>
	
	<script src="../../utils/jsloader-utils.js" type="text/javascript" charset="utf-8"></script>

	<script src="../deps/highlightjs/highlight.min.js"></script>
	<script src="../deps/angular-highlightjs-searchtext/build/release/angular-highlightjs-searchtext.min.js"></script>
	<script src="../partials/partials.js"></script>
	<script src="../../utils/deps/EventEmitter/EventEmitter.min.js"></script>
	
  </head>
  
  <body spellcheck=false ng-controller="bodyController as listener" ng-cloak>
	
	<div id="listener-header" class="panel-section panel-section-header" style="display: inline;">
	  <div class="text-section-header"> {{label}} || 
		<span>
		  <bdi id="listening_to"> Listening to tab <strong> {{ tabId }} </strong> </bdi>
		</span>
	  	<div class="filter-bucket">
		  <button class="browser-style jslbtn" ng-click="toggleCapture()"> {{ capture_status }} capture </button>
		  <div class="filter-list">
			
			<label ng-repeat="filter in filterOpts track by filter.text" class="filter-label">
			  <input type="checkbox" ng-model="filter.value" ng-change="filter.change(filter.value)">
			  <span> {{ filter.text }} </span>
			</label>
			
		  </div>
		  <label class="filter-label advanced">
			<span> Filter: </span>
			<input class="filter_inpt" type="text" ng-model="advFilter" ng-change="advFilterChange()">
		  </label>
		</div>
	  </div>
	</div>
	
	<div id="content" class="panel-section scrollable" ng-controller="listenerController as listener">
	  <no-info ng-if="!infoShown()"></no-info>

	  <ul style="display:block;">
		  
		<li ng-repeat="req in list" ng-show="req.shown">
		  
		  <json-formatter json="req.request" open="1" ng-click="req.toggleList($event)" urlclick="urlClick" style="display:block;"></json-formatter><br>
		  <json-formatter json="req.responses" open="0" ng-show="req.visible" urlclick="urlClick" style="display:block;"></json-formatter><br ng-show="req.visible">
		  
		  <button class="browser-style" ng-show="req.visible" ng-click="blockOps(req)"> {{ req.blockStatus() }} </button>
		  <hr ng-show="req.visible"><br ng-show="req.visible">
		  
		</li>

		<button class="browser-style" ng-show="infoShown()" ng-click="flushRequests()"> Flush </button>
		<button class="browser-style" ng-show="infoShown()" ng-click="downloadCapture()"> Download </button> 
		<button class="browser-style" ng-show="noBlocked()" ng-click="un_blockSelection()"> Block All </button>
		<button class="browser-style" ng-show="noUnblocked()" ng-click="un_blockSelection()"> Unblock all </button>
		<a id="bottom"></a>

	  </ul>
	  
	</div>
	
	<script src="../deps/json/json-formatter.js"></script>
	<script src="listener.js"></script>
	
  </body>
</html>
