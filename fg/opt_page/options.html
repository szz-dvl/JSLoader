<!DOCTYPE html>

<html>
  <head ng-controller="themeController as theme">
	
		<meta charset="utf-8">
		<link rel="stylesheet" href="options.css"/>
		<!-- <link rel="stylesheet" href="../deps/highlightjs/default.min.css"> -->
		<link rel="stylesheet" href="chrome://browser/content/extension.css">
		
		<link ng-if="!current.knownToHl" rel="stylesheet" ng-href="../deps/highlightjs/default.min.css">
		<link ng-if="current.knownToHl" rel="stylesheet" ng-href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/{{current.knownToHl}}.min.css">

		<!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous"> -->
		<link rel="stylesheet" href="../deps/angular-highlightjs-searchtext/build/release/angular-highlightjs-searchtext.min.css">
		
		<script src="../deps/jquery.min.js"></script>
		<script src="../deps/angular.min.js"></script>
		<script src="../deps/highlightjs/highlight.min.js"></script>
		<script src="../deps/angular-highlightjs-searchtext/build/release/angular-highlightjs-searchtext.min.js"></script>
		
		<!-- <script src="../deps/highlightjs-line-numbers.min.js"></script> -->

		<!-- <script src="../deps/handlebars.js"></script> -->
		
		
		<!-- <script src="../deps/angular-highlightjs.min.js"></script> -->

		
		
		
  </head>
	
  <body>

	<div id="content" class="panel-section">

	  <div ng-controller="editorController as editor" class="panel-section" ng-cloak>
		
		<div class="panel-section" >
		  <div id="settings_head" class="panel-section panel-section-header">
			<div class="text-section-header"> {{title}} </div>
		  </div>
		</div><br>
		
		<div id="form-container" class="panel-section">
		  
		  <form ng-submit="updtOpts()">
			
			<label ng-repeat="opt in opts" class="input">

			  <span ng-if="['text'].includes(opt.type)">{{opt.text}}: </span>
			  <input id="{{opt.id}}" type="{{opt.type}}" ng-model="opt.value" ng-change="opt.change()">
			  <span ng-if="['checkbox'].includes(opt.type)" >{{opt.text}}</span>
			  
			</label><br>
			
			<label class="input">

			  <span> Editor theme: </span>
			  <select ng-model="page.themes.current" ng-options="theme.name group by theme.title for theme in page.themes.list" ng-change="page.themes.themeChange()"></select><br><br>

			</label><br><br>
			
			<input type="submit" value="Save Options" class="browser-style jsload-button">
			
		  </form>
		  
		</div>
		
	  </div> <!-- editorController -->
	  
	  <div ng-controller="scriptsController" class="panel-section" ng-cloak>

		<div class="panel-section" >
		  <div id="scripts_head" class="panel-section panel-section-header">
			<div class="text-section-header">{{title}}</div>
		  </div>
		</div><br>
		
		<div class="panel-section" ng-repeat="domain in domains">
		  
		  <h4> {{domain.name}} </h4>
		  
		  <ul> 

			<li class="site-list" ng-if="domain.scripts.length">

			  <label class="click" ng-click="clickSite($event)">
				<bdi class="path-name">/</bdi>
			  </label>
			  
			  <ul class="script-list"> 
				
				<li class="script-bucket hidden-elem" ng-repeat="script in domain.scripts"> 

				  <label class="click" ng-click="clickScript($event)">
					<bdi id="{{script.name}}" class="code-uuid hidden-elem"> {{script.name}} </bdi>
				  </label>
				  
				  <div id="{{script.uuid}}" class="code-bucket hidden-script">
					<!-- <pre class="hidden-script"><code hljs hljs-source="script.code" class="lang-js"></code></pre> -->
					<hljs-search class="hidden-script" code="script.code" language="'javascript'" linenumber="getOptVal('showGutter')"></hljs-search>
					<table class="btn-panel hidden-script">
					  <tr align="center">
						<td class="left">
						  <button id="edit-btn_{{script.uuid}}" class="browser-style mright edit-script hidden-script" data-domain="{{domain.name}}" ng-click="editScript($event)"> Edit </button>
						</td>
						<td class="right">
						  <button id="remove-btn_{{script.uuid}}" class="browser-style mright remove-script hidden-script" data-domain="{{domain.name}}" ng-click="removeScript($event)"> Remove </button>
						</td>
					  </tr>
					</table>
				  </div><br>
				</li>
				
			  </ul>
			</li>
			
			<li class="site-list" ng-repeat="site in domain.sites" ng-if="site.scripts.length"> 

			  <label class="click" ng-click="clickSite($event)">
				<bdi class="path-name">{{site.url}}</bdi>
			  </label>
			  
			  <ul class="script-list"> 
				
				<li class="script-bucket hidden-elem" ng-repeat="script in site.scripts"> 

				  <label class="click" ng-click="clickScript($event)">
					<bdi id="{{script.name}}" class="code-uuid hidden-elem"> {{script.name}} </bdi>
				  </label>
				  
				  <div id="{{script.uuid}}" class="code-bucket hidden-script">
					<!-- <pre class="hidden-script"><code hljs hljs-source="script.code" class="lang-js" class="lang-js"></code></pre> -->
					<hljs-search class="hidden-script" code="script.code" language="'javascript'" linenumber="getOptVal('showGutter')"></hljs-search>
					<table class="btn-panel hidden-script">
					  <tr align="center">
						<td class="left">
						  <button id="edit-btn_{{script.uuid}}" class="browser-style mright edit-script hidden-script" data-domain="{{domain.name}}" ng-click="editScript($event)"> Edit </button>
						</td>
						<td class="right">
						  <button id="remove-btn_{{script.uuid}}" class="browser-style mright remove-script hidden-script" data-domain="{{domain.name}}" ng-click="removeScript($event)"> Remove </button>
						</td>
					  </tr>
					</table>
				  </div><br>
				</li>
				
			  </ul>
			</li>
		  </ul>
		  <div class="panel-section-separator"></div>
		</div>

		<!-- Dirty trick to highlight code after DOM is ready ==> https://stackoverflow.com/questions/12304291/angularjs-how-to-run-additional-code-after-angularjs-has-rendered-a-template -->
		<!-- <span ng-show="highLightCode()"></span> -->
		
	  </div> <!-- scriptsController -->
	</div> <!-- content -->

	<script src="options.js"></script>
  </body>
</html>
